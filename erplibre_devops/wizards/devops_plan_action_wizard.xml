<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record id="devops_plan_action_form" model="ir.ui.view">
        <field name="name">devops.plan.action.form</field>
        <field name="model">devops.plan.action.wizard</field>
        <field name="mode">primary</field>
        <field name="inherit_id" ref="multi_step_wizard.multi_step_wizard_form" />
        <field name="arch" type="xml">
            <xpath expr="//button[@name='open_next']" position="replace">
                <button
                    name="open_next"
                    string="Next"
                    type="object"
                    class="btn-primary"
                    attrs="{'invisible': [('has_next', '=', False)]}"
                />
            </xpath>
            <xpath expr="//footer" position="before">
                <field name="root_workspace_id_is_me" invisible="True" />
                <field name="root_workspace_id" invisible="True" />
                <field name="has_next" invisible="True" />
                <field name="ssh_test_work" invisible="True" />
                <field name="is_update_system" invisible="True" />
                <!--                <h1>-->
                <!--                    <field name="name"-->
                <!--                           attrs="{'readonly': [('state', '!=', 'start')]}"-->
                <!--                           class="oe_inline"-->
                <!--                           placeholder="Name"/>-->
                <!--                </h1>-->
                <group name="init" attrs="{'invisible': [('state', '!=', 'init')]}">
                    <group string="Project">
                        <button
                            name="state_goto_g_test_erplibre"
                            string="Operate"
                            type="object"
                            class="btn btn-default"
                        />
                        <button
                            name="state_goto_g_new_module"
                            string="Create module"
                            type="object"
                            class="btn btn-default"
                        />
                        <button
                            name="state_goto_c_existing_module"
                            string="Refactor module"
                            type="object"
                            class="btn btn-default"
                        />
                        <!--                        <button-->
                        <!--                            name="state_goto_f_new_project_society"-->
                        <!--                            string="New society"-->
                        <!--                            type="object"-->
                        <!--                            class="btn btn-default"-->
                        <!--                        />-->
                        <button
                            name="state_goto_a_autopoiesis_devops"
                            string="Autopoiesis"
                            type="object"
                            class="btn btn-default"
                            attrs="{'invisible': [('root_workspace_id_is_me', '=', False)]}"
                        />
                        <!--                        <button-->
                        <!--                            name="state_goto_not_supported"-->
                        <!--                            string="Import data"-->
                        <!--                            type="object"-->
                        <!--                            class="btn btn-default"-->
                        <!--                        />-->
                        <!--                        <button-->
                        <!--                            name="state_goto_not_supported"-->
                        <!--                            string="Migrate from external DDB"-->
                        <!--                            type="object"-->
                        <!--                            class="btn btn-default"-->
                        <!--                        />-->
                    </group>
                    <group string="Deploy">
                        <!--                        <button-->
                        <!--                            name="state_goto_i_new_remote_system"-->
                        <!--                            string="Local system"-->
                        <!--                            type="object"-->
                        <!--                            class="btn btn-default"-->
                        <!--                        />-->
                        <button
                            name="state_goto_i_new_remote_system"
                            string="Remote system"
                            type="object"
                            class="btn btn-default"
                        />
                    </group>
                    <group string="Quality">
                        <button name="state_goto_h_run_test" string="Test" type="object" class="btn btn-default" />
                        <!--                        <button-->
                        <!--                            name="state_goto_not_supported"-->
                        <!--                            string="Analyse/inspection"-->
                        <!--                            type="object"-->
                        <!--                            class="btn btn-default"-->
                        <!--                        />-->
                    </group>
                </group>
                <group
                    name="group_a_autopoiesis_devops"
                    attrs="{'invisible': [('state', '!=', 'a_autopoiesis_devops')]}"
                >
                    <group string="Adding feature">
                        <button name="state_goto_a_a_model" string="Add model" type="object" class="btn btn-default" />
                        <button
                            name="state_goto_a_b_field"
                            string="Add field"
                            type="object"
                            class="btn btn-default"
                            invisible="True"
                        />
                        <button
                            name="state_goto_a_c_action"
                            string="Add action"
                            type="object"
                            class="btn btn-default"
                            invisible="True"
                        />
                        <button
                            name="state_goto_a_d_view"
                            string="Add view"
                            type="object"
                            class="btn btn-default"
                            invisible="True"
                        />
                    </group>
                    <group string="Regenerate feature">
                        <!--                        <button name="state_goto_a_e_cg_regen" string="Code Generator regenerate" type="object" class="btn btn-default" />-->
                        <button
                            name="state_goto_a_f_devops_regen"
                            string="DevOps regenerate"
                            type="object"
                            class="btn btn-default"
                        />
                        <!--                        <button name="state_goto_a_g_regen" string="Regenerate the choosing module" type="object" class="btn btn-default" />-->
                    </group>
                </group>
                <group
                    name="group_a_a_model"
                    attrs="{'invisible': [('state', '!=', 'a_a_model'),('state', '!=', 'c_a_model')]}"
                >
                    <group string="Module" attrs="{'invisible': [('state', '!=', 'c_a_model')]}">
                        <field name="working_module_id" />
                        <field name="working_module_name" string="OR Working Module Name" />
                    </group>
                    <group>
                        <field name="model_ids" />
                        <field name="model_to_remove_ids" />
                    </group>
                </group>
                <group name="group_a_f_devops_regen" attrs="{'invisible': [('state', '!=', 'a_f_devops_regen')]}">
                    <group string="Param">
                        <field name="force_generate" />
                    </group>
                </group>
                <group name="group_g_test_erplibre" attrs="{'invisible': [('state', '!=', 'g_test_erplibre')]}">
                    <group string="Where">
                        <button name="state_goto_g_a_local" string="Local" type="object" class="btn btn-default" />
                    </group>
                </group>
                <group name="group_g_new_module" attrs="{'invisible': [('state', '!=', 'g_new_module')]}">
                    <group string="Information">
                        <field name="working_module_name" />
                        <field name="working_module_name_suggestion" />
                        <field
                            name="working_module_path"
                            attrs="{'invisible': [('working_module_name_suggestion', '!=', False)]}"
                        />
                    </group>
                    <group string="Feature" />
                </group>
                <group name="group_g_a_local" attrs="{'invisible': [('state', '!=', 'g_a_local')]}">
                    <group string="DB">
                        <field name="image_db_selection" />
                    </group>
                    <group string="Package">
                        <field name="enable_package_srs" />
                    </group>
                </group>
                <group
                    name="group_f_new_project_society"
                    attrs="{'invisible': [('state', '!=', 'f_new_project_society')]}"
                >
                    <group>
                        <button name="state_goto_a_a_model" string="Add model" type="object" class="btn btn-default" />
                        <button name="state_goto_a_b_field" string="Add field" type="object" class="btn btn-default" />
                        <button
                            name="state_goto_a_c_action"
                            string="Add action"
                            type="object"
                            class="btn btn-default"
                        />
                        <button name="state_goto_a_d_view" string="Add view" type="object" class="btn btn-default" />
                    </group>
                </group>
                <group name="group_c_existing_module" attrs="{'invisible': [('state', '!=', 'c_existing_module')]}">
                    <group string="Option">
                        <button name="state_goto_c_a_model" string="Add model" type="object" class="btn btn-default" />
                    </group>
                </group>
                <group name="group_i_new_remote_system" attrs="{'invisible': [('state', '!=', 'i_new_remote_system')]}">
                    <div>
                        Requirement :
                        <ul>
                            <li>Ubuntu OS (22.04 tested)</li>
                            <li>
                                Install openssh-server
                                <b>sudo apt install openssh-server</b>
                            </li>
                            <li>
                                Get your username, password and your ip
                                <b>ip a</b>
                                (or your host name)
                            </li>
                        </ul>
                        <button
                            name="search_subsystem_workspace"
                            string="Update sub-system"
                            type="object"
                            class="btn btn-default"
                        />
                    </div>
                    <group string="SSH information">
                        <field name="ssh_system_id" string="Existing system" options="{'no_create': True}" />
                        <field name="ssh_system_name" />
                        <field name="ssh_user" />
                        <field name="ssh_password" password="True" />
                        <field name="ssh_host" />
                        <field name="ssh_port" />
                        <button
                            name="ssh_create_and_test"
                            string="Create system and test"
                            type="object"
                            class="btn btn-default"
                            attrs="{'invisible': [('ssh_system_id', '!=', False)]}"
                        />
                        <button
                            name="ssh_test_system_exist"
                            string="Update system and re-test"
                            type="object"
                            class="btn btn-default"
                            attrs="{'invisible': [('ssh_system_id', '=', False)]}"
                        />
                        <div
                            class="bg-warning"
                            attrs="{'invisible': ['|',('ssh_test_work', '=', True),('ssh_system_id', '=', False)]}"
                        >
                            Test SSH connection fail.
                        </div>
                    </group>
                    <group string="A-Installation" attrs="{'invisible': [('ssh_test_work', '=', False)]}">
                        <group string="1-Test comm">
                            <button
                                name="ssh_system_open_terminal"
                                string="Test open terminal"
                                type="object"
                                class="btn btn-default"
                            />
                        </group>
                        <group string="2-OS">
                            <button
                                name="ssh_system_install_dev_minimal"
                                string="Minimal installation"
                                type="object"
                                class="btn btn-default"
                            />
                        </group>
                    </group>
                </group>
                <group
                    string="B-Workspace"
                    attrs="{'invisible': ['|',('ssh_test_work', '=', False),('state', '!=', 'i_new_remote_system')]}"
                >
                    <group string="Information">
                        <field name="workspace_folder" />
                        <field name="mode_source" />
                        <field name="mode_exec" />
                        <field name="mode_environnement" />
                        <field name="mode_version_erplibre" />
                        <field name="mode_version_base" />
                        <field name="image_db_selection" />
                        <button
                            name="ssh_system_create_workspace"
                            string="Create workspace"
                            type="object"
                            class="btn btn-default"
                        />
                        <field
                            name="create_workspace_id"
                            attrs="{'invisible': [('create_workspace_id', '=', False)]}"
                        />
                    </group>
                </group>
                <group name="group_h_run_test" attrs="{'invisible': [('state', '!=', 'h_run_test')]}">
                    <group string="Test plan">
                        <button
                            name="state_goto_h_a_test_plan_exec"
                            string="Run new test plan execution"
                            type="object"
                            class="btn btn-default"
                        />
                        <!--                        <button-->
                        <!--                            name="state_goto_h_b_cg"-->
                        <!--                            string="Code generator by selection"-->
                        <!--                            type="object"-->
                        <!--                            class="btn btn-default"-->
                        <!--                        />-->
                    </group>
                </group>
                <group name="group_h_b_cg" attrs="{'invisible': [('state', '!=', 'h_b_cg')]}">
                    <group string="Test type" />
                </group>
                <!--                <group name="group_a_autopoiesis_devops" attrs="{'invisible': [('state', '!=', 'a_a_model')]}">-->
                <!--                    <group>-->
                <!--                        <field name="model_name" />-->
                <!--                    </group>-->
                <!--                </group>-->
                <group name="not_supported" attrs="{'invisible': [('state', '!=', 'not_supported')]}">
                    <p>This state is not supported, please go back.</p>
                </group>
                <div name="final" attrs="{'invisible': [('state', '!=', 'final')]}">
                    <p>The planification is now configured, close this dialog below.</p>
                    <group>
                        <field name="plan_cg_id" attrs="{'invisible': [('plan_cg_id', '=', False)]}" />
                        <field
                            name="generated_new_project_id"
                            attrs="{'invisible': [('generated_new_project_id', '=', False)]}"
                        />
                        <field
                            name="create_workspace_id"
                            attrs="{'invisible': [('create_workspace_id', '=', False)]}"
                        />
                        <button
                            name="action_git_commit"
                            string="Git commit"
                            type="object"
                            class="oe_highlight"
                            attrs="{'invisible': [('plan_cg_id', '=', False)]}"
                        />
                    </group>
                </div>
            </xpath>
        </field>
    </record>

    <record id="devops_plan_action_action" model="ir.actions.act_window">
        <field name="name">Plan action</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">devops.plan.action.wizard</field>
        <field name="src_model">devops.workspace</field>
        <field name="view_mode">form</field>
        <field name="view_type">form</field>
        <field name="target">new</field>
    </record>
</odoo>
